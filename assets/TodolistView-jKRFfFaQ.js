import{r,h as z,i as O,j as T,c as v,o as h,b as e,d as V,t as g,w as B,v as D,f as M,n as f,g as p,F as N,k as S}from"./index-B6nk2Eg0.js";import{a as c,L as F}from"./LoadingOverlay-BKr1O9S3.js";import"./plugin-vueexport-helper-DlAUqK2U.js";const j="/vue-2025-todolist-final/assets/empty%201-CjFDVSGm.png",E={id:"todoListPage",class:"bg-half"},G={class:"todo_sm"},I={href:"#"},K={class:"container todoListPage vhContainer"},P={class:"todoList_Content"},J={class:"inputBox"},U={key:0,class:"todoList_list"},q={class:"todoList_tab"},A={class:"todoList_items"},H={class:"todoList_item"},Q={class:"todoList_label"},R=["onChange","checked"],W=["onClick"],X={class:"todoList_statistics"},Y={key:1,class:"todoList_default"},d="https://todolist-api.hexschool.io",oe={__name:"TodolistView",setup(Z){const n=r(document.cookie.replace(/(?:^|.*;\s*)customTodoToken\s*=\s*([^;]*).*$/i,"$1")),o=r(!1),m=r({nickname:"",uid:""});z(async()=>{try{o.value=!0;const t=await c.get(`${d}/users/checkout`,{headers:{authorization:n.value}});console.log(t),m.value=t.data,y()}catch(t){console.log(t),alert("驗證失敗，請重新登入"),O.push("login")}finally{o.value=!1}});const l=r([]),y=async()=>{const t=await c.get(`${d}/todos/`,{headers:{authorization:n.value}});l.value=t.data.data},w=async()=>{try{o.value=!0;const t=await c.post(`${d}/users/sign_out`,{},{headers:{authorization:n.value}});console.log(t),document.cookie="customTodoToken=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/"}catch(t){console.log(t),alert("登出失敗")}finally{o.value=!1}},i=r(""),k=async()=>{try{o.value=!0;const t=await c.post(`${d}/todos/`,{content:i.value},{headers:{authorization:n.value}});l.value.push(t.data.newTodo),i.value=""}catch(t){console.log(t),alert("新增失敗，請重新輸入待辦事項")}finally{o.value=!1}},u=r("all"),_=t=>{u.value=t},L=async t=>{try{o.value=!0;const s=await c.patch(`${d}/todos/${t}/toggle`,{},{headers:{authorization:n.value}});console.log(s)}catch(s){console.log(s)}finally{o.value=!1}},$=T(()=>u.value==="unfinished"?l.value.filter(t=>!t.status):u.value==="done"?l.value.filter(t=>t.status):l.value),C=T(()=>l.value.filter(t=>t.status===!1).length),b=async t=>{try{o.value=!0,await c.delete(`${d}/todos/${t}`,{headers:{authorization:n.value}}),y()}catch(s){console.log(s)}finally{o.value=!1}};return(t,s)=>(h(),v("div",E,[e("nav",null,[s[4]||(s[4]=e("h1",null,[e("a",{href:"#"},"ONLINE TODO LIST")],-1)),e("ul",null,[e("li",G,[e("a",I,[e("span",null,g(m.value.nickname)+"的待辦",1)])]),e("li",null,[e("a",{onClick:w,href:"#login"},"登出")])])]),e("div",K,[e("div",P,[e("div",J,[B(e("input",{"onUpdate:modelValue":s[0]||(s[0]=a=>i.value=a),onKeyup:M(k,["enter"]),type:"text",placeholder:"請輸入待辦事項"},null,544),[[D,i.value]]),e("a",{onClick:p(k,["prevent"]),class:f({disabled:!i.value.trim()}),href:"#"},[e("i",{class:f(["fa fa-plus",i.value.trim()?"fa-plus":"fa-ban"])},null,2)],2)]),l.value.length!==0?(h(),v("div",U,[e("ul",q,[e("li",null,[e("a",{onClick:s[1]||(s[1]=p(a=>_("all"),["prevent"])),class:f({active:u.value==="all"}),href:"#"}," 全部 ",2)]),e("li",null,[e("a",{onClick:s[2]||(s[2]=p(a=>_("unfinished"),["prevent"])),class:f({active:u.value==="unfinished"}),href:"#"}," 待完成 ",2)]),e("li",null,[e("a",{onClick:s[3]||(s[3]=p(a=>_("done"),["prevent"])),class:f({active:u.value==="done"}),href:"#"},"已完成",2)])]),e("div",A,[e("ul",H,[(h(!0),v(N,null,S($.value,a=>(h(),v("li",{key:a.id},[e("label",Q,[e("input",{onChange:x=>L(a.id),checked:a.status,class:"todoList_input",type:"checkbox"},null,40,R),e("span",null,g(a.content),1)]),e("a",{onClick:p(x=>b(a.id),["prevent"]),href:"#"},[...s[5]||(s[5]=[e("i",{class:"fa fa-times"},null,-1)])],8,W)]))),128))]),e("div",X,[e("p",null,g(C.value)+" 個未完成項目",1)])])])):(h(),v("div",Y,[...s[6]||(s[6]=[e("p",null,"目前尚無待辦事項",-1),e("img",{src:j,alt:"無待辦事項"},null,-1)])]))])]),V(F,{show:o.value},null,8,["show"])]))}};export{oe as default};
