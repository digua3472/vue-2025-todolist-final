import{r as m,a as y,c as p,o as d,b as o,d as b,w as u,e as c,v as g,f as w,t as f,g as _,u as C}from"./index-B6nk2Eg0.js";import{L as k,a as x}from"./LoadingOverlay-BKr1O9S3.js";import{v as V}from"./validate-BA5-fWI4.js";import"./plugin-vueexport-helper-DlAUqK2U.js";const E={id:"loginPage",class:"bg-yellow"},I={class:"container loginPage vhContainer"},S={class:"formControls",action:"index.html"},L={key:0},B={key:1},D="https://todolist-api.hexschool.io",P={__name:"LoginView",setup(K){const v=C(),a=m(""),l=m(""),n=m(!1),t=y({email:"",password:""}),h={email:{presence:{allowEmpty:!1,message:"^此欄位不可留空"},email:{message:"^必須是正確的 Email 格式"}},password:{presence:{allowEmpty:!1,message:"^此欄位不可留空"},length:{minimum:6,message:"^密碼至少需要 6 碼"}}},r=async()=>{const i={email:a.value,password:l.value},s=V(i,h);if(s){t.email=s.email?s.email[0]:"",t.password=s.password?s.password[0]:"",console.log("驗證失敗：",s);return}try{n.value=!0;const e=await x.post(`${D}/users/sign_in`,i);document.cookie=`customTodoToken=${e.data.token};path=/`,alert("登入成功"),v.push("todolist")}catch(e){alert(`登入失敗： ${e.response.data.message}`)}finally{n.value=!1}};return(i,s)=>(d(),p("div",E,[o("div",I,[s[6]||(s[6]=o("div",{class:"side"},[o("a",{href:"#"},[o("img",{class:"logoImg",src:"https://raw.githubusercontent.com/hexschool/2022-web-layout-training/main/todolist/logo.png",alt:""})]),o("img",{class:"d-m-n",src:"https://raw.githubusercontent.com/hexschool/2022-web-layout-training/main/todolist/img.png",alt:"workImg"})],-1)),o("div",null,[o("form",S,[s[2]||(s[2]=o("h2",{class:"formControls_txt"},"最實用的線上代辦事項服務",-1)),s[3]||(s[3]=o("label",{class:"formControls_label",for:"email"},"Email",-1)),u(o("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>a.value=e),onKeyup:w(r,["enter"]),class:"formControls_input",type:"text",id:"email",name:"email",placeholder:"請輸入 email"},null,544),[[g,a.value]]),t.email?(d(),p("span",L,f(t.email),1)):c("",!0),s[4]||(s[4]=o("label",{class:"formControls_label",for:"pwd"},"密碼",-1)),u(o("input",{"onUpdate:modelValue":s[1]||(s[1]=e=>l.value=e),onKeyup:w(r,["enter"]),class:"formControls_input",type:"password",name:"pwd",id:"pwd",placeholder:"請輸入密碼"},null,544),[[g,l.value]]),t.password?(d(),p("span",B,f(t.password),1)):c("",!0),o("input",{onClick:_(r,["prevent"]),class:"formControls_btnSubmit",type:"button",value:"登入"}),s[5]||(s[5]=o("a",{class:"formControls_btnLink",href:"#signup"},"註冊帳號",-1))])])]),b(k,{show:n.value},null,8,["show"])]))}};export{P as default};
